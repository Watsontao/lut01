{"ast":null,"code":"import axios from 'axios';\nimport VChart from 'vue-echarts';\n\n// 注册 echarts 必要模块\nimport * as echarts from 'echarts/core';\nimport { CanvasRenderer } from 'echarts/renderers';\nimport { LineChart } from 'echarts/charts';\nimport { TitleComponent, TooltipComponent, GridComponent, DatasetComponent, LegendComponent } from 'echarts/components';\n\n// 注册 echarts 所需组件\necharts.use([CanvasRenderer, LineChart, TitleComponent, TooltipComponent, GridComponent, DatasetComponent, LegendComponent]);\nexport default {\n  name: 'GreenhouseDetail',\n  components: {\n    VChart\n  },\n  data() {\n    return {\n      greenhouse: {},\n      temperatureChart: {},\n      humidityChart: {},\n      mixedChart: {}\n    };\n  },\n  created() {\n    const id = this.$route.query.id;\n    this.loadGreenhouse(id);\n    this.loadEnvData(id);\n  },\n  methods: {\n    loadGreenhouse(id) {\n      this.$request.get(`/api/greenhouse/getById?id=${id}`).then(res => {\n        this.greenhouse = res.data || {};\n      });\n    },\n    loadEnvData(id) {\n      axios.get(`/api/environment/history/${id}`).then(res => {\n        const records = res.data || [];\n        const dates = records.map(r => r.recordDate);\n        this.temperatureChart = {\n          xAxis: {\n            type: 'category',\n            data: dates\n          },\n          yAxis: {\n            type: 'value'\n          },\n          series: [{\n            data: records.map(r => r.temperature),\n            type: 'line',\n            smooth: true\n          }]\n        };\n        this.humidityChart = {\n          xAxis: {\n            type: 'category',\n            data: dates\n          },\n          yAxis: {\n            type: 'value'\n          },\n          series: [{\n            data: records.map(r => r.humidity),\n            type: 'line',\n            smooth: true\n          }]\n        };\n        this.mixedChart = {\n          tooltip: {},\n          legend: {\n            data: ['土壤湿度', '光照强度']\n          },\n          xAxis: {\n            type: 'category',\n            data: dates\n          },\n          yAxis: {\n            type: 'value'\n          },\n          series: [{\n            name: '土壤湿度',\n            type: 'line',\n            data: records.map(r => r.soilMoisture),\n            smooth: true\n          }, {\n            name: '光照强度',\n            type: 'line',\n            data: records.map(r => r.lightIntensity),\n            smooth: true\n          }]\n        };\n      });\n    }\n  }\n};","map":{"version":3,"names":["axios","VChart","echarts","CanvasRenderer","LineChart","TitleComponent","TooltipComponent","GridComponent","DatasetComponent","LegendComponent","use","name","components","data","greenhouse","temperatureChart","humidityChart","mixedChart","created","id","$route","query","loadGreenhouse","loadEnvData","methods","$request","get","then","res","records","dates","map","r","recordDate","xAxis","type","yAxis","series","temperature","smooth","humidity","tooltip","legend","soilMoisture","lightIntensity"],"sources":["src/views/manager/GreenhouseDetail.vue"],"sourcesContent":["<script>\r\nimport axios from 'axios'\r\nimport VChart from 'vue-echarts'\r\n\r\n// 注册 echarts 必要模块\r\nimport * as echarts from 'echarts/core'\r\nimport { CanvasRenderer } from 'echarts/renderers'\r\nimport { LineChart } from 'echarts/charts'\r\nimport {\r\n  TitleComponent,\r\n  TooltipComponent,\r\n  GridComponent,\r\n  DatasetComponent,\r\n  LegendComponent\r\n} from 'echarts/components'\r\n\r\n// 注册 echarts 所需组件\r\necharts.use([\r\n  CanvasRenderer,\r\n  LineChart,\r\n  TitleComponent,\r\n  TooltipComponent,\r\n  GridComponent,\r\n  DatasetComponent,\r\n  LegendComponent\r\n])\r\n\r\nexport default {\r\n  name: 'GreenhouseDetail',\r\n  components: {\r\n    VChart\r\n  },\r\n  data() {\r\n    return {\r\n      greenhouse: {},\r\n      temperatureChart: {},\r\n      humidityChart: {},\r\n      mixedChart: {}\r\n    }\r\n  },\r\n  created() {\r\n    const id = this.$route.query.id\r\n    this.loadGreenhouse(id)\r\n    this.loadEnvData(id)\r\n  },\r\n  methods: {\r\n    loadGreenhouse(id) {\r\n      this.$request.get(`/api/greenhouse/getById?id=${id}`).then(res => {\r\n        this.greenhouse = res.data || {}\r\n      })\r\n    },\r\n    loadEnvData(id) {\r\n      axios.get(`/api/environment/history/${id}`).then(res => {\r\n        const records = res.data || []\r\n        const dates = records.map(r => r.recordDate)\r\n\r\n        this.temperatureChart = {\r\n          xAxis: { type: 'category', data: dates },\r\n          yAxis: { type: 'value' },\r\n          series: [{ data: records.map(r => r.temperature), type: 'line', smooth: true }]\r\n        }\r\n\r\n        this.humidityChart = {\r\n          xAxis: { type: 'category', data: dates },\r\n          yAxis: { type: 'value' },\r\n          series: [{ data: records.map(r => r.humidity), type: 'line', smooth: true }]\r\n        }\r\n\r\n        this.mixedChart = {\r\n          tooltip: {},\r\n          legend: { data: ['土壤湿度', '光照强度'] },\r\n          xAxis: { type: 'category', data: dates },\r\n          yAxis: { type: 'value' },\r\n          series: [\r\n            { name: '土壤湿度', type: 'line', data: records.map(r => r.soilMoisture), smooth: true },\r\n            { name: '光照强度', type: 'line', data: records.map(r => r.lightIntensity), smooth: true }\r\n          ]\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n"],"mappings":"AACA,OAAAA,KAAA;AACA,OAAAC,MAAA;;AAEA;AACA,YAAAC,OAAA;AACA,SAAAC,cAAA;AACA,SAAAC,SAAA;AACA,SACAC,cAAA,EACAC,gBAAA,EACAC,aAAA,EACAC,gBAAA,EACAC,eAAA,QACA;;AAEA;AACAP,OAAA,CAAAQ,GAAA,EACAP,cAAA,EACAC,SAAA,EACAC,cAAA,EACAC,gBAAA,EACAC,aAAA,EACAC,gBAAA,EACAC,eAAA,CACA;AAEA;EACAE,IAAA;EACAC,UAAA;IACAX;EACA;EACAY,KAAA;IACA;MACAC,UAAA;MACAC,gBAAA;MACAC,aAAA;MACAC,UAAA;IACA;EACA;EACAC,QAAA;IACA,MAAAC,EAAA,QAAAC,MAAA,CAAAC,KAAA,CAAAF,EAAA;IACA,KAAAG,cAAA,CAAAH,EAAA;IACA,KAAAI,WAAA,CAAAJ,EAAA;EACA;EACAK,OAAA;IACAF,eAAAH,EAAA;MACA,KAAAM,QAAA,CAAAC,GAAA,+BAAAP,EAAA,IAAAQ,IAAA,CAAAC,GAAA;QACA,KAAAd,UAAA,GAAAc,GAAA,CAAAf,IAAA;MACA;IACA;IACAU,YAAAJ,EAAA;MACAnB,KAAA,CAAA0B,GAAA,6BAAAP,EAAA,IAAAQ,IAAA,CAAAC,GAAA;QACA,MAAAC,OAAA,GAAAD,GAAA,CAAAf,IAAA;QACA,MAAAiB,KAAA,GAAAD,OAAA,CAAAE,GAAA,CAAAC,CAAA,IAAAA,CAAA,CAAAC,UAAA;QAEA,KAAAlB,gBAAA;UACAmB,KAAA;YAAAC,IAAA;YAAAtB,IAAA,EAAAiB;UAAA;UACAM,KAAA;YAAAD,IAAA;UAAA;UACAE,MAAA;YAAAxB,IAAA,EAAAgB,OAAA,CAAAE,GAAA,CAAAC,CAAA,IAAAA,CAAA,CAAAM,WAAA;YAAAH,IAAA;YAAAI,MAAA;UAAA;QACA;QAEA,KAAAvB,aAAA;UACAkB,KAAA;YAAAC,IAAA;YAAAtB,IAAA,EAAAiB;UAAA;UACAM,KAAA;YAAAD,IAAA;UAAA;UACAE,MAAA;YAAAxB,IAAA,EAAAgB,OAAA,CAAAE,GAAA,CAAAC,CAAA,IAAAA,CAAA,CAAAQ,QAAA;YAAAL,IAAA;YAAAI,MAAA;UAAA;QACA;QAEA,KAAAtB,UAAA;UACAwB,OAAA;UACAC,MAAA;YAAA7B,IAAA;UAAA;UACAqB,KAAA;YAAAC,IAAA;YAAAtB,IAAA,EAAAiB;UAAA;UACAM,KAAA;YAAAD,IAAA;UAAA;UACAE,MAAA,GACA;YAAA1B,IAAA;YAAAwB,IAAA;YAAAtB,IAAA,EAAAgB,OAAA,CAAAE,GAAA,CAAAC,CAAA,IAAAA,CAAA,CAAAW,YAAA;YAAAJ,MAAA;UAAA,GACA;YAAA5B,IAAA;YAAAwB,IAAA;YAAAtB,IAAA,EAAAgB,OAAA,CAAAE,GAAA,CAAAC,CAAA,IAAAA,CAAA,CAAAY,cAAA;YAAAL,MAAA;UAAA;QAEA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}