{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  name: 'Farmer',\n  data() {\n    return {\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      users: [],\n      search: {\n        userName: '',\n        phone: '',\n        role: ''\n      },\n      selected: [] // 存储多选中的用户\n    };\n  },\n\n  created() {\n    this.loadUsers();\n  },\n  methods: {\n    // 查询农工信息\n    loadUsers() {\n      this.$request.get('/api/user/getAllUser').then(res => {\n        const all = res.data || [];\n        // 过滤出角色为“农民工”或“worker”，并做关键词筛选\n        this.users = all.filter(u => {\n          const isFarmer = u.role === '农民工' || u.role === 'worker';\n          const matchName = u.userName?.includes(this.search.userName);\n          const matchPhone = u.phone?.includes(this.search.phone);\n          const matchRole = this.search.role ? u.role === this.search.role : true;\n          return isFarmer && matchName && matchPhone && matchRole;\n        });\n      });\n    },\n    // 重置搜索条件\n    resetSearch() {\n      this.search = {\n        userName: '',\n        phone: '',\n        role: ''\n      };\n      this.loadUsers();\n    },\n    // 多选变化\n    handleSelectionChange(selection) {\n      this.selected = selection;\n    },\n    // 新增用户（跳转到复用的新增页面或弹窗）\n    handleAdd() {\n      this.$router.push({\n        path: '/adminPerson'\n      }); // 或者改成弹出框\n    },\n\n    // 批量删除\n    handleBatchDelete() {\n      this.$confirm(`是否批量删除选中的 ${this.selected.length} 项？`, '提示', {\n        type: 'warning'\n      }).then(() => {\n        const ids = this.selected.map(u => u.userId);\n        this.$request.post('/api/user/deleteBatch', ids).then(res => {\n          if (res.code === '200') {\n            this.$message.success('批量删除成功');\n            this.loadUsers();\n          } else {\n            this.$message.error(res.msg);\n          }\n        });\n      }).catch(() => {\n        // 取消\n      });\n    }\n  }\n};","map":{"version":3,"names":["name","data","user","JSON","parse","localStorage","getItem","users","search","userName","phone","role","selected","created","loadUsers","methods","$request","get","then","res","all","filter","u","isFarmer","matchName","includes","matchPhone","matchRole","resetSearch","handleSelectionChange","selection","handleAdd","$router","push","path","handleBatchDelete","$confirm","length","type","ids","map","userId","post","code","$message","success","error","msg","catch"],"sources":["src/views/manager/Farmer.vue"],"sourcesContent":["<template>\n  <div>\n    <div class=\"card\" style=\"padding: 15px; font-weight: bold; font-size: 20px;\">\n      您好，{{ user?.userName }}！欢迎使用本系统\n    </div>\n\n    <div class=\"card\" style=\"margin-top: 20px;\">\n      <div style=\"margin-bottom: 20px; font-size: 18px; font-weight: bold\">农工信息列表</div>\n\n      <!-- 搜索区域 -->\n      <div style=\"margin-bottom: 20px;\">\n        <el-input v-model=\"search.userName\" placeholder=\"请输入姓名\" style=\"width: 200px; margin-right: 10px\" />\n        <el-input v-model=\"search.phone\" placeholder=\"请输入电话\" style=\"width: 200px; margin-right: 10px\" />\n        <el-select v-model=\"search.role\" placeholder=\"选择角色\" style=\"width: 150px; margin-right: 10px\">\n          <el-option label=\"农民工\" value=\"农民工\" />\n          <el-option label=\"worker\" value=\"worker\" />\n        </el-select>\n\n        <el-button type=\"primary\" @click=\"loadUsers\">查询</el-button>\n        <el-button @click=\"resetSearch\">重置</el-button>\n        <el-button type=\"success\" @click=\"handleAdd\">新增</el-button>\n        <el-button type=\"danger\" @click=\"handleBatchDelete\" :disabled=\"selected.length === 0\">批量删除</el-button>\n      </div>\n\n      <!-- 表格展示 -->\n      <el-table :data=\"users\" border stripe style=\"width: 100%\" @selection-change=\"handleSelectionChange\">\n        <el-table-column type=\"selection\" width=\"55\" />\n        <el-table-column prop=\"userId\" label=\"ID\" width=\"60\"/>\n        <el-table-column prop=\"userName\" label=\"姓名\"/>\n        <el-table-column prop=\"phone\" label=\"电话\"/>\n        <el-table-column prop=\"role\" label=\"角色\"/>\n        <el-table-column prop=\"gender\" label=\"性别\"/>\n        <el-table-column prop=\"idCard\" label=\"身份证号\"/>\n        <el-table-column prop=\"address\" label=\"地址\"/>\n        <el-table-column prop=\"createDate\" label=\"创建时间\"/>\n        <el-table-column prop=\"imageUrl\" label=\"头像URL\"/>\n      </el-table>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'Farmer',\n  data() {\n    return {\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      users: [],\n      search: {\n        userName: '',\n        phone: '',\n        role: ''\n      },\n      selected: []  // 存储多选中的用户\n    }\n  },\n  created() {\n    this.loadUsers()\n  },\n  methods: {\n    // 查询农工信息\n    loadUsers() {\n      this.$request.get('/api/user/getAllUser').then(res => {\n        const all = res.data || []\n        // 过滤出角色为“农民工”或“worker”，并做关键词筛选\n        this.users = all.filter(u => {\n          const isFarmer = u.role === '农民工' || u.role === 'worker'\n          const matchName = u.userName?.includes(this.search.userName)\n          const matchPhone = u.phone?.includes(this.search.phone)\n          const matchRole = this.search.role ? u.role === this.search.role : true\n          return isFarmer && matchName && matchPhone && matchRole\n        })\n      })\n    },\n\n    // 重置搜索条件\n    resetSearch() {\n      this.search = {\n        userName: '',\n        phone: '',\n        role: ''\n      }\n      this.loadUsers()\n    },\n\n    // 多选变化\n    handleSelectionChange(selection) {\n      this.selected = selection\n    },\n\n    // 新增用户（跳转到复用的新增页面或弹窗）\n    handleAdd() {\n      this.$router.push({ path: '/adminPerson' })  // 或者改成弹出框\n    },\n\n    // 批量删除\n    handleBatchDelete() {\n      this.$confirm(`是否批量删除选中的 ${this.selected.length} 项？`, '提示', {\n        type: 'warning'\n      }).then(() => {\n        const ids = this.selected.map(u => u.userId)\n        this.$request.post('/api/user/deleteBatch', ids).then(res => {\n          if (res.code === '200') {\n            this.$message.success('批量删除成功')\n            this.loadUsers()\n          } else {\n            this.$message.error(res.msg)\n          }\n        })\n      }).catch(() => {\n        // 取消\n      })\n    }\n  }\n}\n</script>\n"],"mappings":";AA0CA;EACAA,IAAA;EACAC,KAAA;IACA;MACAC,IAAA,EAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;MACAC,KAAA;MACAC,MAAA;QACAC,QAAA;QACAC,KAAA;QACAC,IAAA;MACA;MACAC,QAAA;IACA;EACA;;EACAC,QAAA;IACA,KAAAC,SAAA;EACA;EACAC,OAAA;IACA;IACAD,UAAA;MACA,KAAAE,QAAA,CAAAC,GAAA,yBAAAC,IAAA,CAAAC,GAAA;QACA,MAAAC,GAAA,GAAAD,GAAA,CAAAlB,IAAA;QACA;QACA,KAAAM,KAAA,GAAAa,GAAA,CAAAC,MAAA,CAAAC,CAAA;UACA,MAAAC,QAAA,GAAAD,CAAA,CAAAX,IAAA,cAAAW,CAAA,CAAAX,IAAA;UACA,MAAAa,SAAA,GAAAF,CAAA,CAAAb,QAAA,EAAAgB,QAAA,MAAAjB,MAAA,CAAAC,QAAA;UACA,MAAAiB,UAAA,GAAAJ,CAAA,CAAAZ,KAAA,EAAAe,QAAA,MAAAjB,MAAA,CAAAE,KAAA;UACA,MAAAiB,SAAA,QAAAnB,MAAA,CAAAG,IAAA,GAAAW,CAAA,CAAAX,IAAA,UAAAH,MAAA,CAAAG,IAAA;UACA,OAAAY,QAAA,IAAAC,SAAA,IAAAE,UAAA,IAAAC,SAAA;QACA;MACA;IACA;IAEA;IACAC,YAAA;MACA,KAAApB,MAAA;QACAC,QAAA;QACAC,KAAA;QACAC,IAAA;MACA;MACA,KAAAG,SAAA;IACA;IAEA;IACAe,sBAAAC,SAAA;MACA,KAAAlB,QAAA,GAAAkB,SAAA;IACA;IAEA;IACAC,UAAA;MACA,KAAAC,OAAA,CAAAC,IAAA;QAAAC,IAAA;MAAA;IACA;;IAEA;IACAC,kBAAA;MACA,KAAAC,QAAA,mBAAAxB,QAAA,CAAAyB,MAAA;QACAC,IAAA;MACA,GAAApB,IAAA;QACA,MAAAqB,GAAA,QAAA3B,QAAA,CAAA4B,GAAA,CAAAlB,CAAA,IAAAA,CAAA,CAAAmB,MAAA;QACA,KAAAzB,QAAA,CAAA0B,IAAA,0BAAAH,GAAA,EAAArB,IAAA,CAAAC,GAAA;UACA,IAAAA,GAAA,CAAAwB,IAAA;YACA,KAAAC,QAAA,CAAAC,OAAA;YACA,KAAA/B,SAAA;UACA;YACA,KAAA8B,QAAA,CAAAE,KAAA,CAAA3B,GAAA,CAAA4B,GAAA;UACA;QACA;MACA,GAAAC,KAAA;QACA;MAAA,CACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}